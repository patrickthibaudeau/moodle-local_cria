define("local_cria/assign_users",["exports","jquery","core/ajax","core/templates","./select2"],(function(_exports,_jquery,_ajax,_templates,_select){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_ajax=_interopRequireDefault(_ajax),_templates=_interopRequireDefault(_templates),_select=_interopRequireDefault(_select);function get_assigned_users(role_id){(0,_jquery.default)("#cria-assigned-users").empty(),_ajax.default.call([{methodname:"cria_get_assigned_users",args:{id:role_id}}])[0].done((function(results){_jquery.default.each(results,(function(index,value){(0,_jquery.default)("#cria-assigned-users").append((0,_jquery.default)("<option>",{value:value.id,text:value.firstname+" "+value.lastname}))}))})).fail((function(error){console.log(error),alert("An error has occurred.")}))}function get_all_users(role_id){let name=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";(0,_jquery.default)("#cria-unassigned-users").empty();var all_users=_ajax.default.call([{methodname:"cria_get_users",args:{role_id:role_id,id:-1,name:name}}]);all_users[0].done((function(all_users_results){_jquery.default.each(all_users_results,(function(index,value){(0,_jquery.default)("#cria-unassigned-users").append((0,_jquery.default)("<option>",{value:value.id,text:value.firstname+" "+value.lastname}))}))})).fail((function(){alert("An error has occurred.")}))}_exports.init=()=>{(0,_jquery.default)(".btn-assign-users").off(),(0,_jquery.default)(".btn-assign-users").on("click",(function(){let role_id=(0,_jquery.default)(this).data("roleid"),bot_id=(0,_jquery.default)(this).data("botid"),role_name=(0,_jquery.default)(this).data("rolename");(0,_jquery.default)("#cria-modal-title").html("Assign Users to "+role_name),(0,_jquery.default)("#roleid").val(role_id),(0,_jquery.default)("#botid").val(bot_id),get_assigned_users(role_id),get_all_users(role_id),(0,_jquery.default)("#cria-assign-users").off(),(0,_jquery.default)("#cria-assign-users").on("click",(function(){let role_id=(0,_jquery.default)("#roleid").val();(0,_jquery.default)("#cria-unassigned-users :selected").each((function(i,selected){_ajax.default.call([{methodname:"cria_assign_user_role",args:{role_id:role_id,user_id:(0,_jquery.default)(selected).val()}}])[0].done((function(results){})).fail((function(){alert("An error has occurred.")}))})),setTimeout((function(){get_all_users(role_id)}),500),setTimeout((function(){get_assigned_users(role_id)}),500)})),(0,_jquery.default)("#cria-unassign-users").off(),(0,_jquery.default)("#cria-unassign-users").on("click",(function(){let role_id=(0,_jquery.default)("#roleid").val();(0,_jquery.default)("#cria-assigned-users :selected").each((function(i,selected){_ajax.default.call([{methodname:"cria_unassign_user_role",args:{id:(0,_jquery.default)(selected).val()}}])[0].done((function(results){})).fail((function(){alert("An error has occurred.")}))})),setTimeout((function(){get_all_users(role_id)}),500),setTimeout((function(){get_assigned_users(role_id)}),500)})),(0,_jquery.default)("#cria-search-unassigned-user").on("keyup",(function(){let name=(0,_jquery.default)(this).val();0==name.length&&get_all_users(role_id),name.length>=3&&get_all_users(role_id,name)})),(0,_jquery.default)("#assign-users-modal").modal("show")}))}}));

//# sourceMappingURL=assign_users.min.js.map