{"version":3,"file":"translate.min.js","sources":["../src/translate.js"],"sourcesContent":["import $ from 'jquery';\r\nimport ajax from 'core/ajax';\r\nimport config from 'core/config';\r\n\r\nexport const init = () => {\r\n    process_notes();\r\n};\r\n\r\n/**\r\n * Delete a content\r\n */\r\nfunction process_notes() {\r\n\r\n    $(\"#process-notes\").off();\r\n    $(\"#process-notes\").on('click', function () {\r\n        $('#cria-cost').hide();\r\n        var bot_id = $(this).data('bot_id');\r\n        var language = $('#language').val();\r\n        var content = '[CONTEXT]' + $('#notes').val() + '[/CONTEXT]'\r\n        var voice = $('input[name=voice]:checked').val();\r\n        var paraphrase = $('#paraphrase').val();\r\n            var prompt = '[INSTRUCTIONS]Forget any previous translations and ' ;\r\n\r\n        $('#cria-translation-container').html('<i class=\"fa fa-spinner fa-spin fa-3x fa-fw\"></i><span class=\"sr-only\">...</span>');\r\n\r\n        if (language == 'fr') {\r\n            prompt += 'translate the context into French';\r\n        } else {\r\n            prompt += 'translate the context into English';\r\n        }\r\n\r\n        if (paraphrase == 'yes') {\r\n            prompt += ' and paraphrase the translation without changing the core message while';\r\n        }\r\n\r\n        switch (voice) {\r\n            case \"0\":\r\n                prompt += ' using a neutral tone.';\r\n                break;\r\n            case \"1\":\r\n                prompt += ' using a formal tone.';\r\n                break;\r\n            case \"2\":\r\n                prompt += ' using a an informal tone.';\r\n                break;\r\n            case \"3\":\r\n                prompt += ' using an academic tone.';\r\n                break;\r\n            case \"4\":\r\n                prompt += ' using a literary tone.';\r\n                break;\r\n        }\r\n\r\n        prompt += ' Only provide one translation.[/INSTRUCTIONS]';\r\n\r\n\r\n        $('#process-notes').hide();\r\n        $('#starting-process').show();\r\n        //Delete the record\r\n        var gpt_response = ajax.call([{\r\n            methodname: 'cria_get_gpt_response',\r\n            args: {\r\n                bot_id: bot_id,\r\n                chat_id: 0,\r\n                prompt: prompt,\r\n                content: content\r\n            }\r\n        }]);\r\n\r\n        gpt_response[0].done(function (result) {\r\n            let data = JSON.parse(result);\r\n\r\n            $('#starting-process').hide();\r\n            $('#almost-done').show();\r\n            // JQuery Ajax call to process.php\r\n            setTimeout(function () {\r\n                $('#almost-done').hide();\r\n                $('#process-notes').show();\r\n                $('#cria-cost').html('$' + data.cost.toPrecision(6));\r\n                $('#cria-translation-container').html(data.message);\r\n                $('#cria-cost').show();\r\n            }, 2000);\r\n\r\n            // $('#cria-prompt-tokens').html(data.prompt_tokens);\r\n            // $('#cria-completion-tokens').html(data.completion_tokens);\r\n            // $('#cria-total-tokens').html(data.total_tokens);\r\n\r\n        }).fail(function () {\r\n            alert('An error has occurred.');\r\n        });\r\n    });\r\n}"],"names":["off","on","hide","bot_id","this","data","language","val","content","voice","paraphrase","prompt","html","show","ajax","call","methodname","args","chat_id","done","result","JSON","parse","setTimeout","cost","toPrecision","message","fail","alert"],"mappings":"wZAIoB,yBASd,kBAAkBA,0BAClB,kBAAkBC,GAAG,SAAS,+BAC1B,cAAcC,WACZC,QAAS,mBAAEC,MAAMC,KAAK,UACtBC,UAAW,mBAAE,aAAaC,MAC1BC,QAAU,aAAc,mBAAE,UAAUD,MAAQ,aAC5CE,OAAQ,mBAAE,6BAA6BF,MACvCG,YAAa,mBAAE,eAAeH,MAC1BI,OAAS,iFAEf,+BAA+BC,KAAK,qFAGlCD,QADY,MAAZL,SACU,oCAEA,qCAGI,OAAdI,aACAC,QAAU,2EAGNF,WACC,IACDE,QAAU,mCAET,IACDA,QAAU,kCAET,IACDA,QAAU,uCAET,IACDA,QAAU,qCAET,IACDA,QAAU,0BAIlBA,QAAU,oEAGR,kBAAkBT,2BAClB,qBAAqBW,OAEJC,cAAKC,KAAK,CAAC,CAC1BC,WAAY,wBACZC,KAAM,CACFd,OAAQA,OACRe,QAAS,EACTP,OAAQA,OACRH,QAASA,YAIJ,GAAGW,MAAK,SAAUC,YACvBf,KAAOgB,KAAKC,MAAMF,4BAEpB,qBAAqBlB,2BACrB,gBAAgBW,OAElBU,YAAW,+BACL,gBAAgBrB,2BAChB,kBAAkBW,2BAClB,cAAcD,KAAK,IAAMP,KAAKmB,KAAKC,YAAY,wBAC/C,+BAA+Bb,KAAKP,KAAKqB,6BACzC,cAAcb,SACjB,QAMJc,MAAK,WACJC,MAAM"}