{"version":3,"file":"translate.min.js","sources":["../src/translate.js"],"sourcesContent":["import $ from 'jquery';\nimport ajax from 'core/ajax';\nimport config from 'core/config';\n\nexport const init = () => {\n    process_notes();\n};\n\n/**\n * Delete a content\n */\nfunction process_notes() {\n\n    $(\"#process-notes\").off();\n    $(\"#process-notes\").on('click', function () {\n        $('#cria-cost').hide();\n        var bot_id = $(this).data('bot_id');\n        var language = $('#language').val();\n        var content = '[CONTEXT]' + $('#notes').val() + '[/CONTEXT]'\n        var voice = $('input[name=voice]:checked').val();\n        var paraphrase = $('#paraphrase').val();\n            var prompt = '[INSTRUCTIONS]Forget any previous translations and ' ;\n\n        $('#cria-translation-container').html('<i class=\"fa fa-spinner fa-spin fa-3x fa-fw\"></i><span class=\"sr-only\">...</span>');\n\n        if (language == 'fr') {\n            prompt += 'translate the context into French';\n        } else {\n            prompt += 'translate the context into English';\n        }\n\n        if (paraphrase == 'yes') {\n            prompt += ' and paraphrase the translation without changing the core message while';\n        }\n\n        switch (voice) {\n            case \"0\":\n                prompt += ' using a neutral tone.';\n                break;\n            case \"1\":\n                prompt += ' using a formal tone.';\n                break;\n            case \"2\":\n                prompt += ' using a an informal tone.';\n                break;\n            case \"3\":\n                prompt += ' using an academic tone.';\n                break;\n            case \"4\":\n                prompt += ' using a literary tone.';\n                break;\n        }\n\n        prompt += ' Only provide one translation.[/INSTRUCTIONS]';\n\n\n        $('#process-notes').hide();\n        $('#starting-process').show();\n        //Delete the record\n        var gpt_response = ajax.call([{\n            methodname: 'cria_get_gpt_response',\n            args: {\n                bot_id: bot_id,\n                chat_id: 0,\n                prompt: prompt,\n                content: content\n            }\n        }]);\n\n        gpt_response[0].done(function (result) {\n            $('#starting-process').hide();\n            $('#almost-done').show();\n            // JQuery Ajax call to process.php\n            setTimeout(function () {\n                $('#almost-done').hide();\n                $('#process-notes').show();\n                $('#cria-cost').html('$' + result.cost.toPrecision(6));\n                $('#cria-translation-container').html(result.message);\n                $('#cria-cost').show();\n            }, 2000);\n\n            // $('#cria-prompt-tokens').html(data.prompt_tokens);\n            // $('#cria-completion-tokens').html(data.completion_tokens);\n            // $('#cria-total-tokens').html(data.total_tokens);\n\n        }).fail(function () {\n            alert('An error has occurred.');\n        });\n    });\n}"],"names":["off","on","hide","bot_id","this","data","language","val","content","voice","paraphrase","prompt","html","show","ajax","call","methodname","args","chat_id","done","result","setTimeout","cost","toPrecision","message","fail","alert"],"mappings":"wZAIoB,yBASd,kBAAkBA,0BAClB,kBAAkBC,GAAG,SAAS,+BAC1B,cAAcC,WACZC,QAAS,mBAAEC,MAAMC,KAAK,UACtBC,UAAW,mBAAE,aAAaC,MAC1BC,QAAU,aAAc,mBAAE,UAAUD,MAAQ,aAC5CE,OAAQ,mBAAE,6BAA6BF,MACvCG,YAAa,mBAAE,eAAeH,MAC1BI,OAAS,iFAEf,+BAA+BC,KAAK,qFAGlCD,QADY,MAAZL,SACU,oCAEA,qCAGI,OAAdI,aACAC,QAAU,2EAGNF,WACC,IACDE,QAAU,mCAET,IACDA,QAAU,kCAET,IACDA,QAAU,uCAET,IACDA,QAAU,qCAET,IACDA,QAAU,0BAIlBA,QAAU,oEAGR,kBAAkBT,2BAClB,qBAAqBW,OAEJC,cAAKC,KAAK,CAAC,CAC1BC,WAAY,wBACZC,KAAM,CACFd,OAAQA,OACRe,QAAS,EACTP,OAAQA,OACRH,QAASA,YAIJ,GAAGW,MAAK,SAAUC,4BACzB,qBAAqBlB,2BACrB,gBAAgBW,OAElBQ,YAAW,+BACL,gBAAgBnB,2BAChB,kBAAkBW,2BAClB,cAAcD,KAAK,IAAMQ,OAAOE,KAAKC,YAAY,wBACjD,+BAA+BX,KAAKQ,OAAOI,6BAC3C,cAAcX,SACjB,QAMJY,MAAK,WACJC,MAAM"}