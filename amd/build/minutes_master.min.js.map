{"version":3,"file":"minutes_master.min.js","sources":["../src/minutes_master.js"],"sourcesContent":["import $ from 'jquery';\r\nimport ajax from 'core/ajax';\r\nimport config from 'core/config';\r\n\r\nexport const init = () => {\r\n    process_notes();\r\n};\r\n\r\n/**\r\n * Delete a content\r\n */\r\nfunction process_notes() {\r\n\r\n    $(\"#process-notes\").off();\r\n    $(\"#process-notes\").on('click', function () {\r\n        $('#cria-cost').hide();\r\n        var bot_id = $(this).data('bot_id');\r\n        var language = $('#language').val();\r\n        var content = '[CONTEXT]' + $('#notes').val() + '[/CONTEXT]'\r\n        var prompt = `[INSTRUCTIONS]Create meeting notes from the context provided and separate the notes by topic. Each topic should be in a \r\n        numbered list. Once done, create all action items from the context. Format the action items as a list having \r\n        the following headings: Assigned to, Description, Date due[/INSTRUCTIONS]`;\r\n        if (language == 'fr') {\r\n            prompt = `[INSTRUCTIONS]Créez des notes de réunion à partir du context et séparez les notes par sujet. Chaque sujet doit être dans une \r\n            liste numérotée. Une fois terminé, créez toutes les tâches à partir de la transcription. Formatez les \r\n            tâches comme une list ayant les entêtes suivantes: Assigné à, Description, Date d'échéance[/INSTRUCTIONS]`;\r\n        }\r\n        // Get all values from various fields\r\n        var project_name = $('#project_name').val();\r\n        var date = $('#date').val();\r\n        var time = $('#time').val();\r\n        var location = $('#location').val();\r\n\r\n        $('#process-notes').hide();\r\n        $('#starting-process').show();\r\n        //Delete the record\r\n        var gpt_response = ajax.call([{\r\n            methodname: 'cria_get_gpt_response',\r\n            args: {\r\n                bot_id: bot_id,\r\n                chat_id: 0,\r\n                prompt: prompt,\r\n                content: content\r\n            }\r\n        }]);\r\n\r\n        gpt_response[0].done(function (result) {\r\n            let data = JSON.parse(result);\r\n            let form_data = {\r\n                'project_name': project_name,\r\n                'date': date,\r\n                'time': time,\r\n                'location': location,\r\n                'minutes': data.message\r\n            };\r\n            $('#starting-process').hide();\r\n            $('#almost-done').show();\r\n            // JQuery Ajax call to process.php\r\n            setTimeout(function () {\r\n                $('#almost-done').hide();\r\n                $('#process-complete').show();\r\n                $.post(config.wwwroot + \"/local/cria/minutes_master/process.php\", form_data, function (response) {\r\n                    let path_data = JSON.parse(response);\r\n                    window.location.href = config.wwwroot + \"/local/cria/minutes_master/download.php?path=\"\r\n                        + path_data.path + \"&file=\" + path_data.file_name;\r\n                    setTimeout(function () {\r\n                        $('#cria-cost').show();\r\n                        $('#cria-cost').html('$' + data.cost.toPrecision(6));\r\n                        $('#process-complete').hide();\r\n                        $('#process-notes').show();\r\n                    }, 1500);\r\n                });\r\n            }, 2000);\r\n\r\n\r\n            $('#cria-message').html(data.message);\r\n            // $('#cria-prompt-tokens').html(data.prompt_tokens);\r\n            // $('#cria-completion-tokens').html(data.completion_tokens);\r\n            // $('#cria-total-tokens').html(data.total_tokens);\r\n\r\n        }).fail(function () {\r\n            alert('An error has occurred.');\r\n        });\r\n    });\r\n}"],"names":["off","on","hide","bot_id","this","data","language","val","content","prompt","project_name","date","time","location","show","ajax","call","methodname","args","chat_id","done","result","JSON","parse","form_data","message","setTimeout","post","config","wwwroot","response","path_data","window","href","path","file_name","html","cost","toPrecision","fail","alert"],"mappings":"6ZAIoB,yBASd,kBAAkBA,0BAClB,kBAAkBC,GAAG,SAAS,+BAC1B,cAAcC,WACZC,QAAS,mBAAEC,MAAMC,KAAK,UACtBC,UAAW,mBAAE,aAAaC,MAC1BC,QAAU,aAAc,mBAAE,UAAUD,MAAQ,aAC5CE,4UAGY,MAAZH,WACAG,uXAKAC,cAAe,mBAAE,iBAAiBH,MAClCI,MAAO,mBAAE,SAASJ,MAClBK,MAAO,mBAAE,SAASL,MAClBM,UAAW,mBAAE,aAAaN,0BAE5B,kBAAkBL,2BAClB,qBAAqBY,OAEJC,cAAKC,KAAK,CAAC,CAC1BC,WAAY,wBACZC,KAAM,CACFf,OAAQA,OACRgB,QAAS,EACTV,OAAQA,OACRD,QAASA,YAIJ,GAAGY,MAAK,SAAUC,YACvBhB,KAAOiB,KAAKC,MAAMF,QAClBG,UAAY,cACId,kBACRC,UACAC,cACIC,iBACDR,KAAKoB,6BAElB,qBAAqBvB,2BACrB,gBAAgBY,OAElBY,YAAW,+BACL,gBAAgBxB,2BAChB,qBAAqBY,uBACrBa,KAAKC,gBAAOC,QAAU,yCAA0CL,WAAW,SAAUM,cAC/EC,UAAYT,KAAKC,MAAMO,UAC3BE,OAAOnB,SAASoB,KAAOL,gBAAOC,QAAU,gDAClCE,UAAUG,KAAO,SAAWH,UAAUI,UAC5CT,YAAW,+BACL,cAAcZ,2BACd,cAAcsB,KAAK,IAAM/B,KAAKgC,KAAKC,YAAY,wBAC/C,qBAAqBpC,2BACrB,kBAAkBY,SACrB,WAER,yBAGD,iBAAiBsB,KAAK/B,KAAKoB,YAK9Bc,MAAK,WACJC,MAAM"}