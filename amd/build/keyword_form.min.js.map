{"version":3,"file":"keyword_form.min.js","sources":["../src/keyword_form.js"],"sourcesContent":["import $ from 'jquery';\nimport notification from 'core/notification';\nimport ajax from 'core/ajax';\n\nexport const init = () => {\n    edit_synonym();\n    delete_synonym();\n    add_synonym();\n};\n\n/**\n * Edit question example\n */\nfunction edit_synonym() {\n    $(\".edit-synonym\").off();\n    $(\".edit-synonym\").on('click', function () {\n        var id = $(this).data('id');\n        let synonym = $(this)\n        let row = $(this).closest('tr');\n\n        $(this).css('padding', '5px');\n\n        $(this).on('keypress', function (e) {\n            if (e.which == 13) {\n                e.preventDefault();\n                let value = $(this).text();\n                // Update example question\n                var update_content = ajax.call([{\n                    methodname: 'cria_synonym_update',\n                    args: {\n                        id: id,\n                        value: value\n                    }\n                }]);\n\n                update_content[0].done(function ($result) {\n                    // Only add if span doesn't exist\n                    if (row.find('td > span').length == 0) {\n                        let html = '<span class=\"badge badge-pill badge-success\">Saved</span>';\n                        synonym.closest('td').append(html);\n                    }\n                    // Remove focus\n                    question.blur();\n                    $('id_save').focus();\n                }).fail(function () {\n                    alert('An error has occurred. The question was not saved.');\n                });\n            }\n        });\n\n\n    });\n}\n\n/**\n * Delete example question\n */\nfunction delete_synonym() {\n\n    $(\".delete-synonym\").off();\n    $(\".delete-synonym\").on('click', function () {\n        let id = $(this).data('id');\n        let row = $(this).closest('tr')\n\n        notification.confirm('Delete',\n            'Are you sure you want to delete this synonym?',\n            'Delete',\n            M.util.get_string('cancel', 'local_cria'), function () {\n                //Delete the record\n                var delete_content = ajax.call([{\n                    methodname: 'cria_synonym_delete',\n                    args: {\n                        id: id\n                    }\n                }]);\n                delete_content[0].done(function ($result) {\n                    row.remove();\n                }).fail(function () {\n                    alert('An error has occurred. The question example was not saved.');\n                });\n            });\n    });\n}\n\n/**\n * Add question example\n */\nfunction add_synonym() {\n    $('.btn-add-synonym').off();\n    $('.btn-add-synonym').on('click', function () {\n        // Get question id\n        var keyword_id = $('[name=\"id\"]').val();\n        var synonym_text = $('#cria-synonym').val();\n        // Add question example\n        var add_synonym = ajax.call([{\n            methodname: 'cria_synonym_insert',\n            args: {\n                keyword_id: keyword_id,\n                value: synonym_text,\n            }\n        }]);\n\n        add_synonym[0].done(function ($result) {\n            let id = $result;\n            let html = `<tr>\n                        <td>\n                            <div class=\"edit-synonym\" style=\"cursor: pointer;\" contenteditable=\"true\"\n                                 data-id=\"${id}\">${synonym_text}</div>\n                                 <span class=\"badge badge-pill badge-success\">Saved</span>\n                        </td>\n                        <td>\n                            <button type=\"button\" class=\"btn btn-outline-danger delete-synonym\" data-id=\"${id}\">\n                                Delete\n                            </button>\n                        </td>\n                    </tr>` ;\n            // Append new question example\n            $('#cria-synonyms-table').append(html);\n            // Reinitalize events\n            delete_synonym();\n            edit_synonym();\n        }).fail(function () {\n            alert('An error has occurred. The synonym was not saved.');\n        });\n    });\n}"],"names":["edit_synonym","off","on","id","this","data","synonym","row","closest","css","e","which","preventDefault","value","text","ajax","call","methodname","args","done","$result","find","length","html","append","question","blur","focus","fail","alert","delete_synonym","confirm","M","util","get_string","remove","keyword_id","val","synonym_text"],"mappings":"8aAaSA,mCACH,iBAAiBC,0BACjB,iBAAiBC,GAAG,SAAS,eACvBC,IAAK,mBAAEC,MAAMC,KAAK,UAClBC,SAAU,mBAAEF,MACZG,KAAM,mBAAEH,MAAMI,QAAQ,0BAExBJ,MAAMK,IAAI,UAAW,2BAErBL,MAAMF,GAAG,YAAY,SAAUQ,MACd,IAAXA,EAAEC,MAAa,CACfD,EAAEE,qBACEC,OAAQ,mBAAET,MAAMU,OAECC,cAAKC,KAAK,CAAC,CAC5BC,WAAY,sBACZC,KAAM,CACFf,GAAIA,GACJU,MAAOA,UAIA,GAAGM,MAAK,SAAUC,YAEO,GAAhCb,IAAIc,KAAK,aAAaC,OAAa,KAC/BC,KAAO,4DACXjB,QAAQE,QAAQ,MAAMgB,OAAOD,MAGjCE,SAASC,2BACP,WAAWC,WACdC,MAAK,WACJC,MAAM,yEAYjBC,qCAEH,mBAAmB7B,0BACnB,mBAAmBC,GAAG,SAAS,eACzBC,IAAK,mBAAEC,MAAMC,KAAK,MAClBE,KAAM,mBAAEH,MAAMI,QAAQ,4BAEbuB,QAAQ,SACjB,gDACA,SACAC,EAAEC,KAAKC,WAAW,SAAU,eAAe,WAElBnB,cAAKC,KAAK,CAAC,CAC5BC,WAAY,sBACZC,KAAM,CACFf,GAAIA,OAGG,GAAGgB,MAAK,SAAUC,SAC7Bb,IAAI4B,YACLP,MAAK,WACJC,MAAM,qFA1EN,KAChB7B,eACA8B,qCAkFE,oBAAoB7B,0BACpB,oBAAoBC,GAAG,SAAS,eAE1BkC,YAAa,mBAAE,eAAeC,MAC9BC,cAAe,mBAAE,iBAAiBD,MAEpBtB,cAAKC,KAAK,CAAC,CACzBC,WAAY,sBACZC,KAAM,CACFkB,WAAYA,WACZvB,MAAOyB,iBAIH,GAAGnB,MAAK,SAAUC,aACtBjB,GAAKiB,QACLG,oMAG4BpB,gBAAOmC,kSAIwDnC,sKAM7F,wBAAwBqB,OAAOD,MAEjCO,iBACA9B,kBACD4B,MAAK,WACJC,MAAM"}