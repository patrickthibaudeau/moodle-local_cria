define("local_cria/gpt",["exports","jquery","core/ajax"],(function(_exports,_jquery,_ajax){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_ajax=_interopRequireDefault(_ajax);function perform_request(){(0,_jquery.default)("#cria-conversation").html(""),(0,_jquery.default)("#cria-prompt-tokens").html(0),(0,_jquery.default)("#cria-completion-tokens").html(0),(0,_jquery.default)("#cria-total-tokens").html(0),(0,_jquery.default)("#cria-cost").html("$0.00");var bot_id=(0,_jquery.default)("#submit-question").data("bot_id"),prompt=(0,_jquery.default)("#default-user-prompt").val()+(0,_jquery.default)("#user-prompt").val(),content=(0,_jquery.default)("#cria-test-input").val(),chat_id=(0,_jquery.default)("#cria-chat-id").val();0==chat_id&&(chat_id="none"),(0,_jquery.default)("#submit-question").hide(),(0,_jquery.default)("#starting-process").show(),_ajax.default.call([{methodname:"cria_get_gpt_response",args:{bot_id:bot_id,chat_id:chat_id,prompt:prompt,content:content}}])[0].done((function(result){console.log(result);let json=JSON.parse(result.stacktrace);(0,_jquery.default)("#submit-question").show(),(0,_jquery.default)("#starting-process").hide(),(0,_jquery.default)("#cria-conversation").append().html("".concat(result.message)),(0,_jquery.default)("#cria-prompt-tokens").html(result.prompt_tokens),(0,_jquery.default)("#cria-completion-tokens").html(result.completion_tokens),(0,_jquery.default)("#cria-total-tokens").html(result.total_tokens),(0,_jquery.default)("#cria-cost").html("$"+result.cost.toPrecision(6)),(0,_jquery.default)("#stacktrace").html("<pre>"+JSON.stringify(json,null,"\t")+"</pre>"),(0,_jquery.default)("#cria-file-name").html(result.file_name)})).fail((function(e){alert(e.message+" Your prompt contains unsupported characters. Please try again."),location.reload()}))}_exports.init=()=>{(0,_jquery.default)("#submit-question").off(),(0,_jquery.default)("#submit-question").on("click",(function(){perform_request()})),(0,_jquery.default)("#user-prompt").keypress((function(e){if(13==e.which)return perform_request(),!1})),window.addEventListener("beforeunload",(function(e){e.preventDefault(),e.returnValue="",alert("Please wait for the process to complete.")}))}}));

//# sourceMappingURL=gpt.min.js.map