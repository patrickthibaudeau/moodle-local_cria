{"version":3,"file":"question_form.min.js","sources":["../src/question_form.js"],"sourcesContent":["import $ from 'jquery';\nimport notification from 'core/notification';\nimport ajax from 'core/ajax';\n\nexport const init = () => {\n    edit_question_example();\n    delete_example_question();\n    add_question_example();\n};\n\n/**\n * Edit question example\n */\nfunction edit_question_example() {\n\n    $(\".example-question\").off();\n    $(\".example-question\").on('click', function () {\n        var id = $(this).data('id');\n        let question = $(this)\n        console.log(id);\n        $(this).css('padding', '5px');\n\n        $(this).on('keypress', function (e) {\n            if (e.which == 13) {\n                e.preventDefault();\n                let value = $(this).text();\n                // Update example question\n                var update_content = ajax.call([{\n                    methodname: 'cria_question_example_update',\n                    args: {\n                        id: id,\n                        value: value\n                    }\n                }]);\n\n                update_content[0].done(function ($result) {\n                    alert('question updated');\n                    let html = '<span class=\"badge badge-pill badge-warning\">Unpublished</span>';\n                    question.closest('.delete-question-example').prepend(html);\n                }).fail(function () {\n                    alert('An error has occurred. The question was not saved.');\n                });\n            }\n        });\n\n\n    });\n}\n\n/**\n * Delete example question\n */\nfunction delete_example_question() {\n\n    $(\".delete-question-example\").off();\n    $(\".delete-question-example\").on('click', function () {\n        let id = $(this).data('id');\n        let row = $(this).closest('tr')\n\n        notification.confirm('Delete',\n            'Are you sure you want to delete this example question? The example question cannot be recovered.',\n            'Delete',\n            M.util.get_string('cancel', 'local_cria'), function () {\n                //Delete the record\n                var delete_content = ajax.call([{\n                    methodname: 'cria_question_example_delete',\n                    args: {\n                        id: id\n                    }\n                }]);\n                delete_content[0].done(function ($result) {\n                    row.remove();\n                }).fail(function () {\n                    alert('An error has occurred. The question example was not saved.');\n                });\n            });\n    });\n}\n\nfunction add_question_example() {\n    $('.btn-add-question-example').off();\n    $('.btn-add-question-example').on('click', function () {\n        //Avoid the leave page message\n        window.onbeforeunload = null;\n        var question_id = $('[name=\"id\"]').val();\n        var question_text = $('#cria-question-example').val();\n\n        var add_question_example = ajax.call([{\n            methodname: 'cria_question_example_insert',\n            args: {\n                questionid: question_id,\n                value: question_text,\n            }\n        }]);\n\n        add_question_example[0].done(function ($result) {\n            let id = $result;\n            let html = `<tr>\n                        <td>\n                            <div class=\"example-question\" style=\"cursor: pointer;\" contenteditable=\"true\"\n                                 data-id=\"${id}\">${question_text}</div>\n                        </td>\n                        <td>\n                            <span class=\"badge badge-pill badge-warning\">Unpublished</span>\n                            \n                            <button type=\"button\" class=\"btn btn-outline-danger delete-question-example\" data-id=\"${id}\">\n                                Delete\n                            </button>\n                        </td>\n                    </tr>` ;\n            $('#cria-question-examples-table').append(html);\n            delete_example_question();\n        }).fail(function () {\n            alert('An error has occurred. The question example was not saved.');\n        });\n    });\n}"],"names":["delete_example_question","off","on","id","this","data","row","closest","confirm","M","util","get_string","ajax","call","methodname","args","done","$result","remove","fail","alert","question","console","log","css","e","which","preventDefault","value","text","html","prepend","window","onbeforeunload","question_id","val","question_text","questionid","append"],"mappings":"+aAoDSA,8CAEH,4BAA4BC,0BAC5B,4BAA4BC,GAAG,SAAS,eAClCC,IAAK,mBAAEC,MAAMC,KAAK,MAClBC,KAAM,mBAAEF,MAAMG,QAAQ,4BAEbC,QAAQ,SACjB,mGACA,SACAC,EAAEC,KAAKC,WAAW,SAAU,eAAe,WAElBC,cAAKC,KAAK,CAAC,CAC5BC,WAAY,+BACZC,KAAM,CACFZ,GAAIA,OAGG,GAAGa,MAAK,SAAUC,SAC7BX,IAAIY,YACLC,MAAK,WACJC,MAAM,qFArEN,yBAWd,qBAAqBnB,0BACrB,qBAAqBC,GAAG,SAAS,eAC3BC,IAAK,mBAAEC,MAAMC,KAAK,UAClBgB,UAAW,mBAAEjB,MACjBkB,QAAQC,IAAIpB,wBACVC,MAAMoB,IAAI,UAAW,2BAErBpB,MAAMF,GAAG,YAAY,SAAUuB,MACd,IAAXA,EAAEC,MAAa,CACfD,EAAEE,qBACEC,OAAQ,mBAAExB,MAAMyB,OAECjB,cAAKC,KAAK,CAAC,CAC5BC,WAAY,+BACZC,KAAM,CACFZ,GAAIA,GACJyB,MAAOA,UAIA,GAAGZ,MAAK,SAAUC,SAC7BG,MAAM,wBACFU,KAAO,kEACXT,SAASd,QAAQ,4BAA4BwB,QAAQD,SACtDX,MAAK,WACJC,MAAM,gEAlCtBpB,8CA0EE,6BAA6BC,0BAC7B,6BAA6BC,GAAG,SAAS,WAEvC8B,OAAOC,eAAiB,SACpBC,aAAc,mBAAE,eAAeC,MAC/BC,eAAgB,mBAAE,0BAA0BD,MAErBvB,cAAKC,KAAK,CAAC,CAClCC,WAAY,+BACZC,KAAM,CACFsB,WAAYH,YACZN,MAAOQ,kBAIM,GAAGpB,MAAK,SAAUC,aAC/Bd,GAAKc,QACLa,wMAG4B3B,gBAAOiC,2UAKiEjC,sKAKtG,iCAAiCmC,OAAOR,MAC1C9B,6BACDmB,MAAK,WACJC,MAAM"}