{"version":3,"file":"question_form.min.js","sources":["../src/question_form.js"],"sourcesContent":["import $ from 'jquery';\nimport notification from 'core/notification';\nimport ajax from 'core/ajax';\n\nexport const init = () => {\n    edit_question_example();\n    delete_example_question();\n    add_question_example();\n};\n\n/**\n * Edit question example\n */\nfunction edit_question_example() {\n    $(\".example-question\").off();\n    $(\".example-question\").on('click', function () {\n        var id = $(this).data('id');\n        let question = $(this)\n        let row = $(this).closest('tr');\n\n        $(this).css('padding', '5px');\n\n        $(this).on('keypress', function (e) {\n            if (e.which == 13) {\n                e.preventDefault();\n                let value = $(this).text();\n                // Update example question\n                var update_content = ajax.call([{\n                    methodname: 'cria_question_example_update',\n                    args: {\n                        id: id,\n                        value: value\n                    }\n                }]);\n\n                update_content[0].done(function ($result) {\n                    // Only add if span doesn't exist\n                    if (row.find('td > span').length == 0) {\n                        let html = '<span class=\"badge badge-pill badge-warning\">Unpublished</span>';\n                        question.closest('td').append(html);\n                    }\n                    // Remove focus\n                    question.blur();\n                    $('id_save').focus();\n                }).fail(function () {\n                    alert('An error has occurred. The question was not saved.');\n                });\n            }\n        });\n\n\n    });\n}\n\n/**\n * Delete example question\n */\nfunction delete_example_question() {\n\n    $(\".delete-question-example\").off();\n    $(\".delete-question-example\").on('click', function () {\n        let id = $(this).data('id');\n        let row = $(this).closest('tr')\n\n        notification.confirm('Delete',\n            'Are you sure you want to delete this example question? The example question cannot be recovered.',\n            'Delete',\n            M.util.get_string('cancel', 'local_cria'), function () {\n                //Delete the record\n                var delete_content = ajax.call([{\n                    methodname: 'cria_question_example_delete',\n                    args: {\n                        id: id\n                    }\n                }]);\n                delete_content[0].done(function ($result) {\n                    row.remove();\n                }).fail(function () {\n                    alert('An error has occurred. The question example was not saved.');\n                });\n            });\n    });\n}\n\n/**\n * Add question example\n */\nfunction add_question_example() {\n    $('.btn-add-question-example').off();\n    $('.btn-add-question-example').on('click', function () {\n        // Get question id\n        var question_id = $('[name=\"id\"]').val();\n        var question_text = $('#cria-question-example').val();\n        // Add question example\n        var add_question_example = ajax.call([{\n            methodname: 'cria_question_example_insert',\n            args: {\n                questionid: question_id,\n                value: question_text,\n            }\n        }]);\n\n        add_question_example[0].done(function ($result) {\n            let id = $result;\n            let html = `<tr>\n                        <td>\n                            <div class=\"example-question\" style=\"cursor: pointer;\" contenteditable=\"true\"\n                                 data-id=\"${id}\">${question_text}</div>\n                                 <span class=\"badge badge-pill badge-warning\">Unpublished</span>\n                        </td>\n                        <td>\n                            <button type=\"button\" class=\"btn btn-outline-danger delete-question-example\" data-id=\"${id}\">\n                                Delete\n                            </button>\n                        </td>\n                    </tr>` ;\n            // Append new question example\n            $('#cria-question-examples-table').append(html);\n            // Reinitalize events\n            delete_example_question();\n            edit_question_example();\n        }).fail(function () {\n            alert('An error has occurred. The question example was not saved.');\n        });\n    });\n}"],"names":["edit_question_example","off","on","id","this","data","question","row","closest","css","e","which","preventDefault","value","text","ajax","call","methodname","args","done","$result","find","length","html","append","blur","focus","fail","alert","delete_example_question","confirm","M","util","get_string","remove","question_id","val","question_text","questionid"],"mappings":"+aAaSA,4CACH,qBAAqBC,0BACrB,qBAAqBC,GAAG,SAAS,eAC3BC,IAAK,mBAAEC,MAAMC,KAAK,UAClBC,UAAW,mBAAEF,MACbG,KAAM,mBAAEH,MAAMI,QAAQ,0BAExBJ,MAAMK,IAAI,UAAW,2BAErBL,MAAMF,GAAG,YAAY,SAAUQ,MACd,IAAXA,EAAEC,MAAa,CACfD,EAAEE,qBACEC,OAAQ,mBAAET,MAAMU,OAECC,cAAKC,KAAK,CAAC,CAC5BC,WAAY,+BACZC,KAAM,CACFf,GAAIA,GACJU,MAAOA,UAIA,GAAGM,MAAK,SAAUC,YAEO,GAAhCb,IAAIc,KAAK,aAAaC,OAAa,KAC/BC,KAAO,kEACXjB,SAASE,QAAQ,MAAMgB,OAAOD,MAGlCjB,SAASmB,2BACP,WAAWC,WACdC,MAAK,WACJC,MAAM,yEAYjBC,8CAEH,4BAA4B5B,0BAC5B,4BAA4BC,GAAG,SAAS,eAClCC,IAAK,mBAAEC,MAAMC,KAAK,MAClBE,KAAM,mBAAEH,MAAMI,QAAQ,4BAEbsB,QAAQ,SACjB,mGACA,SACAC,EAAEC,KAAKC,WAAW,SAAU,eAAe,WAElBlB,cAAKC,KAAK,CAAC,CAC5BC,WAAY,+BACZC,KAAM,CACFf,GAAIA,OAGG,GAAGgB,MAAK,SAAUC,SAC7Bb,IAAI2B,YACLP,MAAK,WACJC,MAAM,qFA1EN,KAChB5B,wBACA6B,8CAkFE,6BAA6B5B,0BAC7B,6BAA6BC,GAAG,SAAS,eAEnCiC,aAAc,mBAAE,eAAeC,MAC/BC,eAAgB,mBAAE,0BAA0BD,MAErBrB,cAAKC,KAAK,CAAC,CAClCC,WAAY,+BACZC,KAAM,CACFoB,WAAYH,YACZtB,MAAOwB,kBAIM,GAAGlB,MAAK,SAAUC,aAC/BjB,GAAKiB,QACLG,wMAG4BpB,gBAAOkC,kTAIiElC,sKAMtG,iCAAiCqB,OAAOD,MAE1CM,0BACA7B,2BACD2B,MAAK,WACJC,MAAM"}